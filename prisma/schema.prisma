generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

enum UserRole {
  AUTHOR
  EDITOR
  ADMIN
}

enum AgeRating {
  ALL
  FIFTEEN
  NINETEEN
}

enum WorkStatus {
  // 기존 값 (호환성 유지)
  PREPARING // @deprecated - REGISTERED로 대체
  ONGOING // @deprecated - TRANSLATING으로 대체
  // 새 값
  REGISTERED // 등록됨 (원문 등록 대기)
  BIBLE_GENERATING // 설정집 생성중
  BIBLE_DRAFT // 설정집 검토대기
  BIBLE_CONFIRMED // 설정집 확정 (번역 준비 완료)
  TRANSLATING // 번역 진행중
  TRANSLATED // 번역 완료 (윤문가 대기)
  PROOFREADING // 윤문 진행중 (윤문가 배정됨)
  COMPLETED // 완료
}

enum BibleStatus {
  GENERATING
  DRAFT
  CONFIRMED
}

enum BibleJobStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  FAILED
  CANCELLED
}

enum CharacterRole {
  PROTAGONIST
  ANTAGONIST
  SUPPORTING
  MINOR
}

enum TermCategory {
  CHARACTER // 인명
  PLACE // 지명
  ORGANIZATION // 조직/문파
  RANK_TITLE // 관직/제도
  SKILL_TECHNIQUE // 무공/스킬
  ITEM // 사물
  OTHER // 기타
}

enum EventType {
  PLOT
  CHARACTER_DEV
  FORESHADOWING
  REVEAL
  WORLD_BUILDING
}

enum OriginalStatus {
  ONGOING // 원작 연재중
  COMPLETED // 원작 완결
}

enum SourceLanguage {
  ZH // 중국어
  JA // 일본어
  EN // 영어
  OTHER // 기타
}

enum ChapterStatus {
  PENDING
  TRANSLATING
  TRANSLATED
  REVIEWING
  EDITED
  APPROVED
}

model User {
  id            String    @id @default(cuid())
  email         String    @unique
  password      String?
  name          String
  role          UserRole  @default(AUTHOR)
  image         String?
  emailVerified DateTime?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  works        Work[]    @relation("AuthorWorks")
  editingWorks Work[]    @relation("EditorWorks")
  accounts     Account[]
  sessions     Session[]

  // 협업 편집기 관계
  lastEditedChapters Chapter[]         @relation("LastEditedChapters")
  comments           ChapterComment[]  @relation("CommentAuthor")
  resolvedComments   ChapterComment[]  @relation("CommentResolver")
  snapshots          ChapterSnapshot[] @relation("SnapshotAuthor")
  changes            ChapterChange[]   @relation("ChangeAuthor")
  reviewedChanges    ChapterChange[]   @relation("ChangeReviewer")
  activities         ChapterActivity[] @relation("ActivityActor")

  // 매칭 시스템 관계
  editorProfile    EditorProfile?
  authorListings   ProjectListing[]         @relation("AuthorListings")
  authorContracts  ProjectContract[]        @relation("AuthorContracts")
  editorContracts  ProjectContract[]        @relation("EditorContracts")
  revisionRequests ChapterRevisionRequest[] @relation("RevisionRequester")
  authorReviews    EditorReview[]           @relation("AuthorReviews")
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String? @db.Text
  access_token      String? @db.Text
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String? @db.Text
  session_state     String?
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@index([userId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model PasswordResetToken {
  id        String   @id @default(cuid())
  email     String
  token     String   @unique
  expires   DateTime
  createdAt DateTime @default(now())

  @@unique([email, token])
}

model Work {
  id            String     @id @default(cuid())
  titleKo       String
  titleOriginal String
  publisher     String
  ageRating     AgeRating  @default(ALL)
  status        WorkStatus @default(REGISTERED)
  coverImage    String?
  synopsis      String     @db.Text
  genres        String[]

  // 원작 정보
  originalStatus   OriginalStatus @default(COMPLETED)
  sourceLanguage   SourceLanguage @default(ZH)
  expectedChapters Int? // 예상 총 회차 (완결 작품은 확정)

  // 원작 플랫폼
  platformName  String?
  platformUrl   String?
  publishedAt   DateTime?
  totalChapters Int       @default(0)

  authorId String
  author   User   @relation("AuthorWorks", fields: [authorId], references: [id], onDelete: Cascade)

  editorId String?
  editor   User?   @relation("EditorWorks", fields: [editorId], references: [id], onDelete: SetNull)

  chapters     Chapter[]
  glossary     GlossaryItem[]
  creators     Creator[]
  settingBible SettingBible?
  bibleJobs    BibleGenerationJob[]

  // 매칭 시스템 관계
  listings  ProjectListing[]
  contracts ProjectContract[]
  reviews   EditorReview[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([authorId])
  @@index([editorId])
  @@index([status])
  @@index([updatedAt])
}

model Creator {
  id     String @id @default(cuid())
  name   String
  role   String
  workId String
  work   Work   @relation(fields: [workId], references: [id], onDelete: Cascade)

  @@index([workId])
}

model Chapter {
  id                String        @id @default(cuid())
  number            Int
  title             String?
  translatedTitle   String?
  originalContent   String        @db.Text
  translatedContent String?       @db.Text
  editedContent     String?       @db.Text
  status            ChapterStatus @default(PENDING)
  wordCount         Int           @default(0)

  // 번역 중간 저장 메타데이터 (JSON)
  // { lastSavedChunk: number, totalChunks: number, partialResults: string[] }
  translationMeta Json?

  // Track Changes 상태 (JSON - ProseMirror track-changes plugin state)
  trackChangesState Json?

  // 마지막 편집자 추적
  lastEditedById String?
  lastEditedBy   User?     @relation("LastEditedChapters", fields: [lastEditedById], references: [id], onDelete: SetNull)
  lastEditedAt   DateTime?

  workId String
  work   Work   @relation(fields: [workId], references: [id], onDelete: Cascade)

  // 협업 편집기 관계
  comments   ChapterComment[]
  snapshots  ChapterSnapshot[]
  changes    ChapterChange[]
  activities ChapterActivity[]

  // 매칭 시스템 관계
  revisionRequests ChapterRevisionRequest[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([workId, number])
  @@index([workId])
  @@index([status])
  @@index([workId, status])
}

model GlossaryItem {
  id         String  @id @default(cuid())
  original   String
  translated String
  category   String?
  note       String?

  workId String
  work   Work   @relation(fields: [workId], references: [id], onDelete: Cascade)

  @@unique([workId, original])
  @@index([workId])
}

// ============================================
// 번역 로그 및 모니터링
// ============================================

enum LogLevel {
  DEBUG
  INFO
  WARN
  ERROR
}

enum LogCategory {
  TRANSLATION // 번역 관련
  API_CALL // Gemini API 호출
  RATE_LIMIT // Rate limit 관련
  CHUNK // 청크 처리
  CHAPTER // 챕터 처리
  JOB // 작업 전체
  SYSTEM // 시스템
}

model TranslationLog {
  id       String      @id @default(cuid())
  level    LogLevel    @default(INFO)
  category LogCategory @default(TRANSLATION)

  // 관련 엔티티
  jobId      String?
  workId     String?
  chapterId  String?
  chapterNum Int?
  chunkIndex Int?

  // 사용자 정보
  userId    String?
  userEmail String?

  // 로그 내용
  message    String  @db.Text
  errorCode  String? // TranslationError 코드
  errorStack String? @db.Text
  metadata   Json? // 추가 메타데이터 (JSON)

  // 성능 메트릭
  durationMs Int? // 소요 시간
  retryCount Int? // 재시도 횟수

  // 환경 정보
  clientIp  String?
  userAgent String?

  createdAt DateTime @default(now())

  @@index([level])
  @@index([category])
  @@index([jobId])
  @@index([workId])
  @@index([userId])
  @@index([errorCode])
  @@index([createdAt])
  @@index([level, createdAt])
  @@index([category, createdAt]) // 어드민 로그 필터링용
  @@index([level, category]) // 복합 필터링용
  @@index([workId, createdAt]) // 작품별 로그 조회용
}

// 활성 번역 작업 (Cron 기반 - 서버리스 환경 지원)
model ActiveTranslationJob {
  id    String @id @default(cuid())
  jobId String @unique // 클라이언트 식별용 ID

  workId    String
  workTitle String
  userId    String
  userEmail String?

  // 상태
  status           String  @default("PENDING") // PENDING, IN_PROGRESS, PAUSED, COMPLETED, FAILED, CANCELLED
  isPauseRequested Boolean @default(false)

  // Cron 배치 처리 (설정집 생성과 동일한 패턴)
  batchPlan         Json? // number[][] — 챕터 번호 배치 계획
  totalBatches      Int   @default(0)
  currentBatchIndex Int   @default(0) // 0-based, == totalBatches면 완료

  // 재시도 로직
  retryCount Int @default(0)
  maxRetries Int @default(5)
  lastError  String? @db.Text

  // 진행률 (클라이언트 표시용)
  totalChapters     Int
  completedChapters Int @default(0)
  failedChapters    Int @default(0)

  // 현재 진행 중인 챕터 정보
  currentChapterNum Int?
  currentChunkIndex Int?
  totalChunks       Int?

  // 챕터별 상태 (JSON)
  // [{ number, chapterId, status, currentChunk, totalChunks, error? }]
  chaptersProgress Json?

  // 실패한 챕터 번호 목록
  failedChapterNums Int[] @default([])

  // 자동 실패 복구 (완료 후 실패 챕터 자동 재시도)
  autoRetryCount    Int   @default(0) // 최대 2회
  maxAutoRetries    Int   @default(2)

  // 에러 정보
  errorMessage String? @db.Text

  // 낙관적 잠금 (Cron 중복 실행 방지)
  lockedAt DateTime?
  lockedBy String?

  // 시간 정보
  startedAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  completedAt DateTime?

  @@index([workId, status]) // 작품당 활성 작업 조회용
  @@index([workId])
  @@index([userId])
  @@index([status])
  @@index([updatedAt])
}

// 번역 작업 히스토리 (영구 저장)
model TranslationJobHistory {
  id    String @id @default(cuid())
  jobId String @unique // translationManager의 jobId

  workId    String
  workTitle String
  userId    String
  userEmail String?

  status            String // COMPLETED, FAILED, PAUSED
  totalChapters     Int
  completedChapters Int
  failedChapters    Int

  // 실패 정보
  errorMessage      String? @db.Text
  failedChapterNums Int[] // 실패한 챕터 번호 목록

  // 시간 정보
  startedAt   DateTime
  completedAt DateTime?
  durationMs  Int? // 전체 소요 시간

  createdAt DateTime @default(now())

  @@index([workId])
  @@index([userId])
  @@index([status])
  @@index([createdAt])
}

// ============================================
// 설정집 (Setting Bible)
// ============================================

model SettingBible {
  id     String @id @default(cuid())
  workId String @unique
  work   Work   @relation(fields: [workId], references: [id], onDelete: Cascade)

  status  BibleStatus @default(DRAFT)
  version Int         @default(1)

  translationGuide String? @db.Text // 번역 가이드/복선 노트
  analyzedChapters Int     @default(0)

  generatedAt DateTime?
  confirmedAt DateTime?
  confirmedBy String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  characters Character[]
  terms      SettingTerm[]
  events     TimelineEvent[]
}

model Character {
  id      String       @id @default(cuid())
  bibleId String
  bible   SettingBible @relation(fields: [bibleId], references: [id], onDelete: Cascade)

  nameOriginal String
  nameKorean   String
  nameHanja    String?
  titles       String[]
  aliases      String[]

  personality     String?       @db.Text
  speechStyle     String?       @db.Text
  role            CharacterRole @default(SUPPORTING)
  description     String?       @db.Text
  relationships   Json?
  firstAppearance Int?

  sortOrder   Int     @default(0)
  isConfirmed Boolean @default(false)

  @@unique([bibleId, nameOriginal])
  @@index([bibleId])
}

model SettingTerm {
  id      String       @id @default(cuid())
  bibleId String
  bible   SettingBible @relation(fields: [bibleId], references: [id], onDelete: Cascade)

  original        String
  translated      String
  category        TermCategory
  note            String?      @db.Text
  context         String?      @db.Text
  firstAppearance Int?
  frequency       Int          @default(1)

  isConfirmed Boolean @default(false)

  @@unique([bibleId, original])
  @@index([bibleId])
  @@index([category])
}

model TimelineEvent {
  id      String       @id @default(cuid())
  bibleId String
  bible   SettingBible @relation(fields: [bibleId], references: [id], onDelete: Cascade)

  title        String
  description  String    @db.Text
  chapterStart Int
  chapterEnd   Int?
  eventType    EventType @default(PLOT)
  importance   Int       @default(1)

  isForeshadowing      Boolean  @default(false)
  foreshadowNote       String?  @db.Text
  involvedCharacterIds String[]

  @@index([bibleId])
  @@index([chapterStart])
  @@unique([bibleId, title, chapterStart])
}

// ============================================
// 설정집 생성 작업 큐 (Bible Generation Job Queue)
// ============================================

model BibleGenerationJob {
  id     String @id @default(cuid())
  workId String
  work   Work   @relation(fields: [workId], references: [id], onDelete: Cascade)
  userId String

  status            BibleJobStatus @default(PENDING)
  batchPlan         Json           // number[][] — 생성 시 계산해서 저장
  totalBatches      Int
  currentBatchIndex Int            @default(0)
  analyzedChapters  Int            @default(0)

  retryCount   Int     @default(0)
  maxRetries   Int     @default(3)
  errorMessage String? @db.Text
  lastError    String? @db.Text

  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  startedAt   DateTime?
  completedAt DateTime?

  // 낙관적 잠금 (cron 중복 실행 방지)
  lockedAt DateTime?
  lockedBy String?

  @@index([status])
  @@index([workId])
}

// ============================================
// 협업 편집기 (Collaboration Editor)
// ============================================

enum SnapshotType {
  MANUAL // 사용자 직접 생성
  AUTO_SAVE // 자동 저장
  STATUS_CHANGE // 상태 변경 시
  RETRANSLATE // 재번역 전
}

enum ChangeType {
  INSERT
  DELETE
  REPLACE
}

enum ChangeStatus {
  PENDING
  ACCEPTED
  REJECTED
}

enum ActivityType {
  COMMENT_ADDED
  COMMENT_RESOLVED
  COMMENT_REPLIED
  EDIT_MADE
  CHANGE_ACCEPTED
  CHANGE_REJECTED
  STATUS_CHANGED
  SNAPSHOT_CREATED
  SNAPSHOT_RESTORED
}

// 인라인 댓글
model ChapterComment {
  id        String  @id @default(cuid())
  chapterId String
  chapter   Chapter @relation(fields: [chapterId], references: [id], onDelete: Cascade)
  authorId  String
  author    User    @relation("CommentAuthor", fields: [authorId], references: [id], onDelete: Cascade)

  // 답글 지원
  parentId String?
  parent   ChapterComment?  @relation("CommentReplies", fields: [parentId], references: [id], onDelete: Cascade)
  replies  ChapterComment[] @relation("CommentReplies")

  content    String  @db.Text
  textRange  Json? // {from: number, to: number} - ProseMirror positions
  quotedText String? @db.Text

  isResolved   Boolean   @default(false)
  resolvedAt   DateTime?
  resolvedById String?
  resolvedBy   User?     @relation("CommentResolver", fields: [resolvedById], references: [id], onDelete: SetNull)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([chapterId])
  @@index([chapterId, isResolved])
  @@index([authorId])
  @@index([parentId])
}

// 버전 스냅샷
model ChapterSnapshot {
  id        String  @id @default(cuid())
  chapterId String
  chapter   Chapter @relation(fields: [chapterId], references: [id], onDelete: Cascade)
  authorId  String
  author    User    @relation("SnapshotAuthor", fields: [authorId], references: [id], onDelete: Cascade)

  name         String?
  description  String?
  snapshotType SnapshotType @default(MANUAL)

  originalContent   String        @db.Text
  translatedContent String?       @db.Text
  editedContent     String?       @db.Text
  status            ChapterStatus

  triggerEvent String? // 자동 스냅샷 트리거 설명

  createdAt DateTime @default(now())

  @@index([chapterId])
  @@index([chapterId, createdAt])
  @@index([authorId])
}

// 변경 추적 (Track Changes)
model ChapterChange {
  id        String  @id @default(cuid())
  chapterId String
  chapter   Chapter @relation(fields: [chapterId], references: [id], onDelete: Cascade)
  authorId  String
  author    User    @relation("ChangeAuthor", fields: [authorId], references: [id], onDelete: Cascade)

  changeType ChangeType
  fromPos    Int
  toPos      Int
  oldText    String?    @db.Text
  newText    String?    @db.Text

  status       ChangeStatus @default(PENDING)
  reviewedById String?
  reviewedBy   User?        @relation("ChangeReviewer", fields: [reviewedById], references: [id], onDelete: SetNull)
  reviewedAt   DateTime?

  createdAt DateTime @default(now())

  @@index([chapterId])
  @@index([chapterId, status])
  @@index([authorId])
}

// 활동 로그
model ChapterActivity {
  id        String  @id @default(cuid())
  chapterId String
  chapter   Chapter @relation(fields: [chapterId], references: [id], onDelete: Cascade)
  actorId   String
  actor     User    @relation("ActivityActor", fields: [actorId], references: [id], onDelete: Cascade)

  activityType ActivityType
  metadata     Json? // 추가 메타데이터
  summary      String // 사람이 읽을 수 있는 요약

  createdAt DateTime @default(now())

  @@index([chapterId])
  @@index([chapterId, createdAt])
  @@index([actorId])
}

// ============================================
// 매칭 시스템 (Matching System)
// ============================================

enum EditorAvailability {
  AVAILABLE
  BUSY
  UNAVAILABLE
}

enum ProjectListingStatus {
  DRAFT
  OPEN
  CLOSED
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum ApplicationStatus {
  PENDING
  SHORTLISTED
  ACCEPTED
  REJECTED
  WITHDRAWN
}



enum RevisionRequestStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  DISPUTED
}

// 윤문가 프로필
model EditorProfile {
  id     String @id @default(cuid())
  userId String @unique
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  displayName  String?
  bio          String? @db.Text
  portfolioUrl String?

  specialtyGenres String[]
  languages       String[]

  availability  EditorAvailability @default(AVAILABLE)
  maxConcurrent Int                @default(3)

  completedProjects Int    @default(0)
  averageRating     Float?
  totalReviews      Int    @default(0)

  isVerified Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  portfolioItems PortfolioItem[]
  applications   ProjectApplication[]
  reviews        EditorReview[]

  @@index([availability])
  @@index([averageRating])
  @@index([availability, averageRating])
}

// 포트폴리오 아이템
model PortfolioItem {
  id        String        @id @default(cuid())
  profileId String
  profile   EditorProfile @relation(fields: [profileId], references: [id], onDelete: Cascade)

  title       String
  description String? @db.Text
  genre       String?
  sampleText  String? @db.Text

  sortOrder Int      @default(0)
  createdAt DateTime @default(now())

  @@index([profileId])
}

// 프로젝트 공고
model ProjectListing {
  id       String @id @default(cuid())
  workId   String
  work     Work   @relation(fields: [workId], references: [id], onDelete: Cascade)
  authorId String
  author   User   @relation("AuthorListings", fields: [authorId], references: [id], onDelete: Cascade)

  title        String
  description  String  @db.Text
  requirements String? @db.Text

  status     ProjectListingStatus @default(DRAFT)

  budgetMin Int?
  budgetMax Int?
  deadline  DateTime?

  chapterStart Int?
  chapterEnd   Int?

  viewCount        Int @default(0)
  applicationCount Int @default(0)

  publishedAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  applications ProjectApplication[]
  contract     ProjectContract?

  @@index([status])
  @@index([status, publishedAt])
  @@index([workId])
  @@index([authorId])
  @@index([authorId, status])
}

// 지원서
model ProjectApplication {
  id              String         @id @default(cuid())
  listingId       String
  listing         ProjectListing @relation(fields: [listingId], references: [id], onDelete: Cascade)
  editorProfileId String
  editorProfile   EditorProfile  @relation(fields: [editorProfileId], references: [id], onDelete: Cascade)

  proposalMessage String @db.Text
  priceQuote      Int?
  estimatedDays   Int?

  status     ApplicationStatus @default(PENDING)
  authorNote String?           @db.Text

  submittedAt DateTime  @default(now())
  reviewedAt  DateTime?

  @@unique([listingId, editorProfileId])
  @@index([listingId])
  @@index([editorProfileId])
  @@index([status])
  @@index([status, listingId])
}

// 계약
model ProjectContract {
  id        String         @id @default(cuid())
  listingId String         @unique
  listing   ProjectListing @relation(fields: [listingId], references: [id])
  workId    String
  work      Work           @relation(fields: [workId], references: [id])
  authorId  String
  author    User           @relation("AuthorContracts", fields: [authorId], references: [id])
  editorId  String
  editor    User           @relation("EditorContracts", fields: [editorId], references: [id])

  totalAmount     Int?
  startDate       DateTime
  expectedEndDate DateTime?

  chapterStart Int
  chapterEnd   Int?

  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())

  revisionRequests ChapterRevisionRequest[]

  @@index([workId])
  @@index([authorId])
  @@index([authorId, isActive])
  @@index([editorId])
  @@index([editorId, isActive])
  @@index([isActive])
}

// 수정 요청
model ChapterRevisionRequest {
  id            String          @id @default(cuid())
  contractId    String
  contract      ProjectContract @relation(fields: [contractId], references: [id], onDelete: Cascade)
  chapterId     String
  chapter       Chapter         @relation(fields: [chapterId], references: [id], onDelete: Cascade)
  requestedById String
  requestedBy   User            @relation("RevisionRequester", fields: [requestedById], references: [id], onDelete: Cascade)

  reason           String  @db.Text
  specificFeedback String? @db.Text

  status   RevisionRequestStatus @default(PENDING)
  response String?               @db.Text

  requestedAt   DateTime  @default(now())
  completedAt   DateTime?
  revisionCount Int       @default(1)

  @@index([contractId])
  @@index([chapterId])
  @@index([contractId, status])
}

// 리뷰/평점
model EditorReview {
  id              String        @id @default(cuid())
  editorProfileId String
  editorProfile   EditorProfile @relation(fields: [editorProfileId], references: [id], onDelete: Cascade)
  authorId        String
  author          User          @relation("AuthorReviews", fields: [authorId], references: [id], onDelete: Cascade)
  workId          String
  work            Work          @relation(fields: [workId], references: [id])

  overallRating       Int // 1-5
  qualityRating       Int? // 1-5
  speedRating         Int? // 1-5
  communicationRating Int? // 1-5
  content             String? @db.Text

  isPublic  Boolean  @default(true)
  createdAt DateTime @default(now())

  @@unique([editorProfileId, authorId, workId])
  @@index([editorProfileId])
  @@index([editorProfileId, createdAt])
  @@index([authorId])
  @@index([authorId, workId])
}
